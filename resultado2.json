{
  "$schema": "http://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "parameters": {
    "client_Name": {
      "defaultValue": "BORRAR",
      "type": "string"
    },
    "keyvault_ClientID_Pack": {
      "defaultValue": "sophos-velorcios-client-id",
      "type": "string"
    },
    "keyvault_ClientSecret_Pack": {
      "defaultValue": "sophos-velorcios-client-secret",
      "type": "string"
    },
    "keyvault_Name_Pack": {
      "defaultValue": "MSSP-Desarrollo-SOC",
      "type": "string"
    }
  },
  "variables": {},
  "resources": [
    {
      "type": "Microsoft.Resources/deployments",
      "apiVersion": "2025-03-01",
      "name": "Action_Sophos_Block_Domain_Alert_Playbook",
      "dependsOn": [
        "OrchestatorPart_Sophos_Block_IOC_Playbook"
      ],
      "properties": {
        "mode": "Incremental",
        "templateLink": {
          "uri": "https://raw.githubusercontent.com/VelorciosGroup/AzureSentinelARMTemplate/refs/heads/playbook_parse_automation/template_automation/OUTFINAL/out/Action_Sophos_Block_Domain_Alert_Playbook.json",
          "contentVersion": "1.0.0.0"
        },
        "parameters": {
          "workflows_Action_Sophos_Block_Domain_Alert_Playbook_name": {
            "value": "[concat(parameters('client_Name'), '_Action_Sophos_Block_Domain_Alert_Playbook_Playbook')]"
          },
          "workflows_OrchestatorPart_Sophos_Block_IOC_Playbook_externalid": {
            "value": "[concat(parameters('client_Name'), '_OrchestatorPart_Sophos_Block_IOC_Playbook')]"
          },
          "keyvault_Name": {
            "value": "[parameters('keyvault_Name_Pack')]"
          },
          "connections_azuresentinel_Cliente_Action_Sophos_Block_Domain_Playbook_externalid": {
            "value": "/subscriptions/a7be9652-e6e6-4284-b1b2-14b4079f777d/resourceGroups/MSSP_Sentinel_Desarollo_ResourceGroup/providers/Microsoft.Web/connections/azuresentinel-Cliente_Action_Sophos_Block_Domain_Playbook"
          }
        }
      }
    },
    {
      "type": "Microsoft.Resources/deployments",
      "apiVersion": "2025-03-01",
      "name": "Action_Sophos_Block_Domain_Entity_Playbook",
      "dependsOn": [
        "OrchestatorPart_Sophos_Block_IOC_Playbook"
      ],
      "properties": {
        "mode": "Incremental",
        "templateLink": {
          "uri": "https://raw.githubusercontent.com/VelorciosGroup/AzureSentinelARMTemplate/refs/heads/playbook_parse_automation/template_automation/OUTFINAL/out/Action_Sophos_Block_Domain_Entity_Playbook.json",
          "contentVersion": "1.0.0.0"
        },
        "parameters": {
          "workflows_Action_Sophos_Block_Domain_Entity_Playbook_name": {
            "value": "[concat(parameters('client_Name'), '_Action_Sophos_Block_Domain_Entity_Playbook_Playbook')]"
          },
          "workflows_OrchestatorPart_Sophos_Block_IOC_Playbook_externalid": {
            "value": "[concat(parameters('client_Name'), '_OrchestatorPart_Sophos_Block_IOC_Playbook')]"
          },
          "keyvault_Name": {
            "value": "[parameters('keyvault_Name_Pack')]"
          },
          "connections_azuresentinel_Cliente_Action_Sophos_Block_Domain_Playbook_externalid": {
            "value": "/subscriptions/a7be9652-e6e6-4284-b1b2-14b4079f777d/resourceGroups/MSSP_Sentinel_Desarollo_ResourceGroup/providers/Microsoft.Web/connections/azuresentinel-Cliente_Action_Sophos_Block_Domain_Playbook"
          }
        }
      }
    },
    {
      "type": "Microsoft.Resources/deployments",
      "apiVersion": "2025-03-01",
      "name": "Action_Sophos_Block_Domain_Incident_Playbook",
      "dependsOn": [
        "OrchestatorPart_Sophos_Block_IOC_Playbook"
      ],
      "properties": {
        "mode": "Incremental",
        "templateLink": {
          "uri": "https://raw.githubusercontent.com/VelorciosGroup/AzureSentinelARMTemplate/refs/heads/playbook_parse_automation/template_automation/OUTFINAL/out/Action_Sophos_Block_Domain_Incident_Playbook.json",
          "contentVersion": "1.0.0.0"
        },
        "parameters": {
          "workflows_Action_Sophos_Block_Domain_Incident_Playbook_name": {
            "value": "[concat(parameters('client_Name'), '_Action_Sophos_Block_Domain_Incident_Playbook_Playbook')]"
          },
          "workflows_OrchestatorPart_Sophos_Block_IOC_Playbook_externalid": {
            "value": "[concat(parameters('client_Name'), '_OrchestatorPart_Sophos_Block_IOC_Playbook')]"
          },
          "keyvault_Name": {
            "value": "[parameters('keyvault_Name_Pack')]"
          },
          "connections_azuresentinel_Cliente_Action_Sophos_Block_Incident_Domains_Playbook_externalid": {
            "value": "/subscriptions/a7be9652-e6e6-4284-b1b2-14b4079f777d/resourceGroups/MSSP_Sentinel_Desarollo_ResourceGroup/providers/Microsoft.Web/connections/azuresentinel-Cliente_Action_Sophos_Block_Incident_Domains_Playbook"
          }
        }
      }
    },
    {
      "type": "Microsoft.Resources/deployments",
      "apiVersion": "2025-03-01",
      "name": "Action_Sophos_Block_Hash_Alert_Playbook",
      "dependsOn": [
        "OrchestatorPart_Sophos_Block_IOC_Playbook"
      ],
      "properties": {
        "mode": "Incremental",
        "templateLink": {
          "uri": "https://raw.githubusercontent.com/VelorciosGroup/AzureSentinelARMTemplate/refs/heads/playbook_parse_automation/template_automation/OUTFINAL/out/Action_Sophos_Block_Hash_Alert_Playbook.json",
          "contentVersion": "1.0.0.0"
        },
        "parameters": {
          "workflows_Action_Sophos_Block_Hash_Alert_Playbook_name": {
            "value": "[concat(parameters('client_Name'), '_Action_Sophos_Block_Hash_Alert_Playbook_Playbook')]"
          },
          "workflows_OrchestatorPart_Sophos_Block_IOC_Playbook_externalid": {
            "value": "[concat(parameters('client_Name'), '_OrchestatorPart_Sophos_Block_IOC_Playbook')]"
          },
          "keyvault_Name": {
            "value": "[parameters('keyvault_Name_Pack')]"
          },
          "connections_azuresentinel_Cliente_Action_Sophos_Block_Incident_Hashes_Playbook_externalid": {
            "value": "/subscriptions/a7be9652-e6e6-4284-b1b2-14b4079f777d/resourceGroups/MSSP_Sentinel_Desarollo_ResourceGroup/providers/Microsoft.Web/connections/azuresentinel-Cliente_Action_Sophos_Block_Incident_Hashes_Playbook"
          }
        }
      }
    },
    {
      "type": "Microsoft.Resources/deployments",
      "apiVersion": "2025-03-01",
      "name": "Action_Sophos_Block_Hash_Entity_Playbook",
      "dependsOn": [
        "OrchestatorPart_Sophos_Block_IOC_Playbook"
      ],
      "properties": {
        "mode": "Incremental",
        "templateLink": {
          "uri": "https://raw.githubusercontent.com/VelorciosGroup/AzureSentinelARMTemplate/refs/heads/playbook_parse_automation/template_automation/OUTFINAL/out/Action_Sophos_Block_Hash_Entity_Playbook.json",
          "contentVersion": "1.0.0.0"
        },
        "parameters": {
          "workflows_Action_Sophos_Block_Hash_Entity_Playbook_name": {
            "value": "[concat(parameters('client_Name'), '_Action_Sophos_Block_Hash_Entity_Playbook_Playbook')]"
          },
          "workflows_OrchestatorPart_Sophos_Block_IOC_Playbook_externalid": {
            "value": "[concat(parameters('client_Name'), '_OrchestatorPart_Sophos_Block_IOC_Playbook')]"
          },
          "keyvault_Name": {
            "value": "[parameters('keyvault_Name_Pack')]"
          },
          "connections_azuresentinel_Cliente_Action_Sophos_Block_Hash_Playbook_externalid": {
            "value": "/subscriptions/a7be9652-e6e6-4284-b1b2-14b4079f777d/resourceGroups/MSSP_Sentinel_Desarollo_ResourceGroup/providers/Microsoft.Web/connections/azuresentinel-Cliente_Action_Sophos_Block_Hash_Playbook"
          }
        }
      }
    },
    {
      "type": "Microsoft.Resources/deployments",
      "apiVersion": "2025-03-01",
      "name": "Action_Sophos_Block_Hash_Incident_Playbook",
      "dependsOn": [
        "OrchestatorPart_Sophos_Block_IOC_Playbook"
      ],
      "properties": {
        "mode": "Incremental",
        "templateLink": {
          "uri": "https://raw.githubusercontent.com/VelorciosGroup/AzureSentinelARMTemplate/refs/heads/playbook_parse_automation/template_automation/OUTFINAL/out/Action_Sophos_Block_Hash_Incident_Playbook.json",
          "contentVersion": "1.0.0.0"
        },
        "parameters": {
          "workflows_Action_Sophos_Block_Hash_Incident_Playbook_name": {
            "value": "[concat(parameters('client_Name'), '_Action_Sophos_Block_Hash_Incident_Playbook_Playbook')]"
          },
          "workflows_OrchestatorPart_Sophos_Block_IOC_Playbook_externalid": {
            "value": "[concat(parameters('client_Name'), '_OrchestatorPart_Sophos_Block_IOC_Playbook')]"
          },
          "keyvault_Name": {
            "value": "[parameters('keyvault_Name_Pack')]"
          },
          "connections_azuresentinel_Cliente_Action_Sophos_Block_Incident_Hashes_Playbook_externalid": {
            "value": "/subscriptions/a7be9652-e6e6-4284-b1b2-14b4079f777d/resourceGroups/MSSP_Sentinel_Desarollo_ResourceGroup/providers/Microsoft.Web/connections/azuresentinel-Cliente_Action_Sophos_Block_Incident_Hashes_Playbook"
          }
        }
      }
    },
    {
      "type": "Microsoft.Resources/deployments",
      "apiVersion": "2025-03-01",
      "name": "Action_Sophos_Block_IP_Alert_Playbook",
      "dependsOn": [
        "OrchestatorPart_Sophos_Block_IOC_Playbook"
      ],
      "properties": {
        "mode": "Incremental",
        "templateLink": {
          "uri": "https://raw.githubusercontent.com/VelorciosGroup/AzureSentinelARMTemplate/refs/heads/playbook_parse_automation/template_automation/OUTFINAL/out/Action_Sophos_Block_IP_Alert_Playbook.json",
          "contentVersion": "1.0.0.0"
        },
        "parameters": {
          "workflows_Action_Sophos_Block_IP_Alert_Playbook_name": {
            "value": "[concat(parameters('client_Name'), '_Action_Sophos_Block_IP_Alert_Playbook_Playbook')]"
          },
          "workflows_OrchestatorPart_Sophos_Block_IOC_Playbook_externalid": {
            "value": "[concat(parameters('client_Name'), '_OrchestatorPart_Sophos_Block_IOC_Playbook')]"
          },
          "keyvault_Name": {
            "value": "[parameters('keyvault_Name_Pack')]"
          },
          "connections_azuresentinel_Cliente_Action_Sophos_Block_Incident_IPs_Playbook_externalid": {
            "value": "/subscriptions/a7be9652-e6e6-4284-b1b2-14b4079f777d/resourceGroups/MSSP_Sentinel_Desarollo_ResourceGroup/providers/Microsoft.Web/connections/azuresentinel-Cliente_Action_Sophos_Block_Incident_IPs_Playbook"
          }
        }
      }
    },
    {
      "type": "Microsoft.Resources/deployments",
      "apiVersion": "2025-03-01",
      "name": "Action_Sophos_Block_IP_Entity_Playbook",
      "dependsOn": [
        "OrchestatorPart_Sophos_Block_IOC_Playbook"
      ],
      "properties": {
        "mode": "Incremental",
        "templateLink": {
          "uri": "https://raw.githubusercontent.com/VelorciosGroup/AzureSentinelARMTemplate/refs/heads/playbook_parse_automation/template_automation/OUTFINAL/out/Action_Sophos_Block_IP_Entity_Playbook.json",
          "contentVersion": "1.0.0.0"
        },
        "parameters": {
          "workflows_Action_Sophos_Block_IP_Entity_Playbook_name": {
            "value": "[concat(parameters('client_Name'), '_Action_Sophos_Block_IP_Entity_Playbook_Playbook')]"
          },
          "workflows_OrchestatorPart_Sophos_Block_IOC_Playbook_externalid": {
            "value": "[concat(parameters('client_Name'), '_OrchestatorPart_Sophos_Block_IOC_Playbook')]"
          },
          "keyvault_Name": {
            "value": "[parameters('keyvault_Name_Pack')]"
          },
          "connections_azuresentinel_Cliente_Action_Sophos_Block_IP_Playbook_externalid": {
            "value": "/subscriptions/a7be9652-e6e6-4284-b1b2-14b4079f777d/resourceGroups/MSSP_Sentinel_Desarollo_ResourceGroup/providers/Microsoft.Web/connections/azuresentinel-Cliente_Action_Sophos_Block_IP_Playbook"
          }
        }
      }
    },
    {
      "type": "Microsoft.Resources/deployments",
      "apiVersion": "2025-03-01",
      "name": "Action_Sophos_Block_IP_Incident_Playbook",
      "dependsOn": [
        "OrchestatorPart_Sophos_Block_IOC_Playbook"
      ],
      "properties": {
        "mode": "Incremental",
        "templateLink": {
          "uri": "https://raw.githubusercontent.com/VelorciosGroup/AzureSentinelARMTemplate/refs/heads/playbook_parse_automation/template_automation/OUTFINAL/out/Action_Sophos_Block_IP_Incident_Playbook.json",
          "contentVersion": "1.0.0.0"
        },
        "parameters": {
          "workflows_Action_Sophos_Block_IP_Incident_Playbook_name": {
            "value": "[concat(parameters('client_Name'), '_Action_Sophos_Block_IP_Incident_Playbook_Playbook')]"
          },
          "workflows_OrchestatorPart_Sophos_Block_IOC_Playbook_externalid": {
            "value": "[concat(parameters('client_Name'), '_OrchestatorPart_Sophos_Block_IOC_Playbook')]"
          },
          "keyvault_Name": {
            "value": "[parameters('keyvault_Name_Pack')]"
          },
          "connections_azuresentinel_Cliente_Action_Sophos_Block_Incident_IPs_Playbook_externalid": {
            "value": "/subscriptions/a7be9652-e6e6-4284-b1b2-14b4079f777d/resourceGroups/MSSP_Sentinel_Desarollo_ResourceGroup/providers/Microsoft.Web/connections/azuresentinel-Cliente_Action_Sophos_Block_Incident_IPs_Playbook"
          }
        }
      }
    },
    {
      "type": "Microsoft.Resources/deployments",
      "apiVersion": "2025-03-01",
      "name": "Action_Sophos_Device_Isolation_Alert_Playbook",
      "dependsOn": [
        "OrchestatorPart_Sophos_Device_Isolation_Playbook"
      ],
      "properties": {
        "mode": "Incremental",
        "templateLink": {
          "uri": "https://raw.githubusercontent.com/VelorciosGroup/AzureSentinelARMTemplate/refs/heads/playbook_parse_automation/template_automation/OUTFINAL/out/Action_Sophos_Device_Isolation_Alert_Playbook.json",
          "contentVersion": "1.0.0.0"
        },
        "parameters": {
          "workflows_Action_Sophos_Device_Isolation_Alert_Playbook_name": {
            "value": "[concat(parameters('client_Name'), '_Action_Sophos_Device_Isolation_Alert_Playbook_Playbook')]"
          },
          "workflows_OrchestatorPart_Sophos_Device_Isolation_Playbook_externalid": {
            "value": "[concat(parameters('client_Name'), '_OrchestatorPart_Sophos_Device_Isolation_Playbook')]"
          },
          "keyvault_Name": {
            "value": "[parameters('keyvault_Name_Pack')]"
          },
          "connections_azuresentinel_6_externalid": {
            "value": "/subscriptions/a7be9652-e6e6-4284-b1b2-14b4079f777d/resourceGroups/MSSP_Sentinel_Desarollo_ResourceGroup/providers/Microsoft.Web/connections/azuresentinel-6"
          }
        }
      }
    },
    {
      "type": "Microsoft.Resources/deployments",
      "apiVersion": "2025-03-01",
      "name": "Action_Sophos_Device_Isolation_Entity_Playbook",
      "dependsOn": [
        "OrchestatorPart_Sophos_Device_Isolation_Playbook"
      ],
      "properties": {
        "mode": "Incremental",
        "templateLink": {
          "uri": "https://raw.githubusercontent.com/VelorciosGroup/AzureSentinelARMTemplate/refs/heads/playbook_parse_automation/template_automation/OUTFINAL/out/Action_Sophos_Device_Isolation_Entity_Playbook.json",
          "contentVersion": "1.0.0.0"
        },
        "parameters": {
          "workflows_Action_Sophos_Device_Isolation_Entity_Playbook_name": {
            "value": "[concat(parameters('client_Name'), '_Action_Sophos_Device_Isolation_Entity_Playbook_Playbook')]"
          },
          "workflows_OrchestatorPart_Sophos_Device_Isolation_Playbook_externalid": {
            "value": "[concat(parameters('client_Name'), '_OrchestatorPart_Sophos_Device_Isolation_Playbook')]"
          },
          "keyvault_Name": {
            "value": "[parameters('keyvault_Name_Pack')]"
          },
          "connections_azuresentinel_6_externalid": {
            "value": "/subscriptions/a7be9652-e6e6-4284-b1b2-14b4079f777d/resourceGroups/MSSP_Sentinel_Desarollo_ResourceGroup/providers/Microsoft.Web/connections/azuresentinel-6"
          }
        }
      }
    },
    {
      "type": "Microsoft.Resources/deployments",
      "apiVersion": "2025-03-01",
      "name": "Action_Sophos_Device_Isolation_Incident_Playbook",
      "dependsOn": [
        "OrchestatorPart_Sophos_Device_Isolation_Playbook"
      ],
      "properties": {
        "mode": "Incremental",
        "templateLink": {
          "uri": "https://raw.githubusercontent.com/VelorciosGroup/AzureSentinelARMTemplate/refs/heads/playbook_parse_automation/template_automation/OUTFINAL/out/Action_Sophos_Device_Isolation_Incident_Playbook.json",
          "contentVersion": "1.0.0.0"
        },
        "parameters": {
          "workflows_Action_Sophos_Device_Isolation_Incident_Playbook_name": {
            "value": "[concat(parameters('client_Name'), '_Action_Sophos_Device_Isolation_Incident_Playbook_Playbook')]"
          },
          "workflows_OrchestatorPart_Sophos_Device_Isolation_Playbook_externalid": {
            "value": "[concat(parameters('client_Name'), '_OrchestatorPart_Sophos_Device_Isolation_Playbook')]"
          },
          "keyvault_Name": {
            "value": "[parameters('keyvault_Name_Pack')]"
          },
          "connections_azuresentinel_6_externalid": {
            "value": "/subscriptions/a7be9652-e6e6-4284-b1b2-14b4079f777d/resourceGroups/MSSP_Sentinel_Desarollo_ResourceGroup/providers/Microsoft.Web/connections/azuresentinel-6"
          }
        }
      }
    },
    {
      "type": "Microsoft.Resources/deployments",
      "apiVersion": "2025-03-01",
      "name": "Action_Sophos_Launch_Antivirus_Alert_Playbook",
      "dependsOn": [
        "OrchestatorPart_Sophos_Launch_Antivirus_Playbook"
      ],
      "properties": {
        "mode": "Incremental",
        "templateLink": {
          "uri": "https://raw.githubusercontent.com/VelorciosGroup/AzureSentinelARMTemplate/refs/heads/playbook_parse_automation/template_automation/OUTFINAL/out/Action_Sophos_Launch_Antivirus_Alert_Playbook.json",
          "contentVersion": "1.0.0.0"
        },
        "parameters": {
          "workflows_Action_Sophos_Launch_Antivirus_Alert_Playbook_name": {
            "value": "[concat(parameters('client_Name'), '_Action_Sophos_Launch_Antivirus_Alert_Playbook_Playbook')]"
          },
          "workflows_OrchestatorPart_Sophos_Launch_Antivirus_Playbook_externalid": {
            "value": "[concat(parameters('client_Name'), '_OrchestatorPart_Sophos_Launch_Antivirus_Playbook')]"
          },
          "keyvault_Name": {
            "value": "[parameters('keyvault_Name_Pack')]"
          },
          "connections_azuresentinel_Cliente_Action_Sophos_Launch_Antivirus_Playbook_externalid": {
            "value": "/subscriptions/a7be9652-e6e6-4284-b1b2-14b4079f777d/resourceGroups/MSSP_Sentinel_Desarollo_ResourceGroup/providers/Microsoft.Web/connections/azuresentinel-Cliente_Action_Sophos_Launch_Antivirus_Playbook"
          },
          "connections_MSSPDev_Deshabilitar_Reglas_ApiConnection_externalid": {
            "value": "/subscriptions/a7be9652-e6e6-4284-b1b2-14b4079f777d/resourceGroups/MSSP_Sentinel_Desarollo_ResourceGroup/providers/Microsoft.Web/connections/MSSPDev_Deshabilitar_Reglas_ApiConnection"
          }
        }
      }
    },
    {
      "type": "Microsoft.Resources/deployments",
      "apiVersion": "2025-03-01",
      "name": "Action_Sophos_Launch_Antivirus_Entity_Playbook",
      "dependsOn": [
        "OrchestatorPart_Sophos_Launch_Antivirus_Playbook"
      ],
      "properties": {
        "mode": "Incremental",
        "templateLink": {
          "uri": "https://raw.githubusercontent.com/VelorciosGroup/AzureSentinelARMTemplate/refs/heads/playbook_parse_automation/template_automation/OUTFINAL/out/Action_Sophos_Launch_Antivirus_Entity_Playbook.json",
          "contentVersion": "1.0.0.0"
        },
        "parameters": {
          "workflows_Action_Sophos_Launch_Antivirus_Entity_Playbook_name": {
            "value": "[concat(parameters('client_Name'), '_Action_Sophos_Launch_Antivirus_Entity_Playbook_Playbook')]"
          },
          "workflows_OrchestatorPart_Sophos_Launch_Antivirus_Playbook_externalid": {
            "value": "[concat(parameters('client_Name'), '_OrchestatorPart_Sophos_Launch_Antivirus_Playbook')]"
          },
          "keyvault_Name": {
            "value": "[parameters('keyvault_Name_Pack')]"
          },
          "connections_azuresentinel_Cliente_Action_Sophos_Launch_Antivirus_Playbook_externalid": {
            "value": "/subscriptions/a7be9652-e6e6-4284-b1b2-14b4079f777d/resourceGroups/MSSP_Sentinel_Desarollo_ResourceGroup/providers/Microsoft.Web/connections/azuresentinel-Cliente_Action_Sophos_Launch_Antivirus_Playbook"
          }
        }
      }
    },
    {
      "type": "Microsoft.Resources/deployments",
      "apiVersion": "2025-03-01",
      "name": "Action_Sophos_Launch_Antivirus_Incident_Playbook",
      "dependsOn": [
        "OrchestatorPart_Sophos_Launch_Antivirus_Playbook"
      ],
      "properties": {
        "mode": "Incremental",
        "templateLink": {
          "uri": "https://raw.githubusercontent.com/VelorciosGroup/AzureSentinelARMTemplate/refs/heads/playbook_parse_automation/template_automation/OUTFINAL/out/Action_Sophos_Launch_Antivirus_Incident_Playbook.json",
          "contentVersion": "1.0.0.0"
        },
        "parameters": {
          "workflows_Action_Sophos_Launch_Antivirus_Incident_Playbook_name": {
            "value": "[concat(parameters('client_Name'), '_Action_Sophos_Launch_Antivirus_Incident_Playbook_Playbook')]"
          },
          "workflows_OrchestatorPart_Sophos_Launch_Antivirus_Playbook_externalid": {
            "value": "[concat(parameters('client_Name'), '_OrchestatorPart_Sophos_Launch_Antivirus_Playbook')]"
          },
          "keyvault_Name": {
            "value": "[parameters('keyvault_Name_Pack')]"
          },
          "connections_azuresentinel_Cliente_Action_Sophos_Launch_Antivirus_Playbook_externalid": {
            "value": "/subscriptions/a7be9652-e6e6-4284-b1b2-14b4079f777d/resourceGroups/MSSP_Sentinel_Desarollo_ResourceGroup/providers/Microsoft.Web/connections/azuresentinel-Cliente_Action_Sophos_Launch_Antivirus_Playbook"
          },
          "connections_MSSPDev_Deshabilitar_Reglas_ApiConnection_externalid": {
            "value": "/subscriptions/a7be9652-e6e6-4284-b1b2-14b4079f777d/resourceGroups/MSSP_Sentinel_Desarollo_ResourceGroup/providers/Microsoft.Web/connections/MSSPDev_Deshabilitar_Reglas_ApiConnection"
          }
        }
      }
    },
    {
      "type": "Microsoft.Resources/deployments",
      "apiVersion": "2025-03-01",
      "name": "Enrich_Sophos_Get_Device_Info_Incident_Playbook",
      "dependsOn": [
        "OrchestatorPart_Sophos_Get_Device_Info_Playbook"
      ],
      "properties": {
        "mode": "Incremental",
        "templateLink": {
          "uri": "https://raw.githubusercontent.com/VelorciosGroup/AzureSentinelARMTemplate/refs/heads/playbook_parse_automation/template_automation/OUTFINAL/out/Enrich_Sophos_Get_Device_Info_Incident_Playbook.json",
          "contentVersion": "1.0.0.0"
        },
        "parameters": {
          "workflows_Enrich_Sophos_Get_Device_Info_Incident_Playbook_name": {
            "value": "[concat(parameters('client_Name'), '_Enrich_Sophos_Get_Device_Info_Incident_Playbook_Playbook')]"
          },
          "workflows_OrchestatorPart_Sophos_Get_Device_Info_Playbook_externalid": {
            "value": "[concat(parameters('client_Name'), '_OrchestatorPart_Sophos_Get_Device_Info_Playbook')]"
          },
          "keyvault_Name": {
            "value": "[parameters('keyvault_Name_Pack')]"
          },
          "connections_azuresentinel_6_externalid": {
            "value": "/subscriptions/a7be9652-e6e6-4284-b1b2-14b4079f777d/resourceGroups/MSSP_Sentinel_Desarollo_ResourceGroup/providers/Microsoft.Web/connections/azuresentinel-6"
          }
        }
      }
    },
    {
      "type": "Microsoft.Resources/deployments",
      "apiVersion": "2025-03-01",
      "name": "Enrich_Sophos_Get_Recent_Alert_Info_Incident_Playbook",
      "dependsOn": [
        "OrchestatorPart_Sophos_Get_Recent_Alert_Info_Playbook"
      ],
      "properties": {
        "mode": "Incremental",
        "templateLink": {
          "uri": "https://raw.githubusercontent.com/VelorciosGroup/AzureSentinelARMTemplate/refs/heads/playbook_parse_automation/template_automation/OUTFINAL/out/Enrich_Sophos_Get_Recent_Alert_Info_Incident_Playbook.json",
          "contentVersion": "1.0.0.0"
        },
        "parameters": {
          "workflows_Enrich_Sophos_Get_Recent_Alert_Info_Incident_Playbook_name": {
            "value": "[concat(parameters('client_Name'), '_Enrich_Sophos_Get_Recent_Alert_Info_Incident_Playbook_Playbook')]"
          },
          "workflows_OrchestatorPart_Sophos_Get_Recent_Alert_Info_Playbook_externalid": {
            "value": "[concat(parameters('client_Name'), '_OrchestatorPart_Sophos_Get_Recent_Alert_Info_Playbook')]"
          },
          "keyvault_Name": {
            "value": "[parameters('keyvault_Name_Pack')]"
          },
          "connections_azuresentinel_Cliente_Enrich_Sophos_Get_Recent_Alert_Info_Playbook_externalid": {
            "value": "/subscriptions/a7be9652-e6e6-4284-b1b2-14b4079f777d/resourceGroups/MSSP_Sentinel_Desarollo_ResourceGroup/providers/Microsoft.Web/connections/azuresentinel-Cliente_Enrich_Sophos_Get_Recent_Alert_Info_Playbook"
          },
          "connections_MSSPDev_Deshabilitar_Reglas_ApiConnection_externalid": {
            "value": "/subscriptions/a7be9652-e6e6-4284-b1b2-14b4079f777d/resourceGroups/MSSP_Sentinel_Desarollo_ResourceGroup/providers/Microsoft.Web/connections/MSSPDev_Deshabilitar_Reglas_ApiConnection"
          }
        }
      }
    },
    {
      "type": "Microsoft.Resources/deployments",
      "apiVersion": "2025-03-01",
      "name": "OrchestatorPart_Sophos_Auth_Playbook",
      "dependsOn": [],
      "properties": {
        "mode": "Incremental",
        "templateLink": {
          "uri": "https://raw.githubusercontent.com/VelorciosGroup/AzureSentinelARMTemplate/refs/heads/playbook_parse_automation/template_automation/OUTFINAL/out/OrchestatorPart_Sophos_Auth_Playbook.json",
          "contentVersion": "1.0.0.0"
        },
        "parameters": {
          "workflows_OrchestatorPart_Sophos_Auth_Playbook_name": {
            "value": "[concat(parameters('client_Name'), '_OrchestatorPart_Sophos_Auth_Playbook_Playbook')]"
          },
          "keyvault_ClientID": {
            "value": "[parameters('keyvault_ClientID_Pack')]"
          },
          "keyvault_ClientSecret": {
            "value": "[parameters('keyvault_ClientSecret_Pack')]"
          },
          "keyvault_Name": {
            "value": "[parameters('keyvault_Name_Pack')]"
          },
          "connections_keyvault_externalid": {
            "value": "/subscriptions/a7be9652-e6e6-4284-b1b2-14b4079f777d/resourceGroups/MSSP_Sentinel_Desarollo_ResourceGroup/providers/Microsoft.Web/connections/keyvault"
          }
        }
      }
    },
    {
      "type": "Microsoft.Resources/deployments",
      "apiVersion": "2025-03-01",
      "name": "OrchestatorPart_Sophos_Block_IOC_Playbook",
      "dependsOn": [
        "OrchestatorPart_Sophos_Auth_Playbook"
      ],
      "properties": {
        "mode": "Incremental",
        "templateLink": {
          "uri": "https://raw.githubusercontent.com/VelorciosGroup/AzureSentinelARMTemplate/refs/heads/playbook_parse_automation/template_automation/OUTFINAL/out/OrchestatorPart_Sophos_Block_IOC_Playbook.json",
          "contentVersion": "1.0.0.0"
        },
        "parameters": {
          "workflows_OrchestatorPart_Sophos_Block_IOC_Playbook_name": {
            "value": "[concat(parameters('client_Name'), '_OrchestatorPart_Sophos_Block_IOC_Playbook_Playbook')]"
          },
          "workflows_OrchestatorPart_Sophos_Auth_Playbook_externalid": {
            "value": "[concat(parameters('client_Name'), '_OrchestatorPart_Sophos_Auth_Playbook')]"
          }
        }
      }
    },
    {
      "type": "Microsoft.Resources/deployments",
      "apiVersion": "2025-03-01",
      "name": "OrchestatorPart_Sophos_Device_Isolation_Playbook",
      "dependsOn": [
        "OrchestatorPart_Sophos_Auth_Playbook"
      ],
      "properties": {
        "mode": "Incremental",
        "templateLink": {
          "uri": "https://raw.githubusercontent.com/VelorciosGroup/AzureSentinelARMTemplate/refs/heads/playbook_parse_automation/template_automation/OUTFINAL/out/OrchestatorPart_Sophos_Device_Isolation_Playbook.json",
          "contentVersion": "1.0.0.0"
        },
        "parameters": {
          "workflows_OrchestatorPart_Sophos_Device_Isolation_Playbook_name": {
            "value": "[concat(parameters('client_Name'), '_OrchestatorPart_Sophos_Device_Isolation_Playbook_Playbook')]"
          },
          "workflows_OrchestatorPart_Sophos_Auth_Playbook_externalid": {
            "value": "[concat(parameters('client_Name'), '_OrchestatorPart_Sophos_Auth_Playbook')]"
          }
        }
      }
    },
    {
      "type": "Microsoft.Resources/deployments",
      "apiVersion": "2025-03-01",
      "name": "OrchestatorPart_Sophos_Get_Device_Info_Playbook",
      "dependsOn": [
        "OrchestatorPart_Sophos_Auth_Playbook"
      ],
      "properties": {
        "mode": "Incremental",
        "templateLink": {
          "uri": "https://raw.githubusercontent.com/VelorciosGroup/AzureSentinelARMTemplate/refs/heads/playbook_parse_automation/template_automation/OUTFINAL/out/OrchestatorPart_Sophos_Get_Device_Info_Playbook.json",
          "contentVersion": "1.0.0.0"
        },
        "parameters": {
          "workflows_OrchestatorPart_Sophos_Get_Device_Info_Playbook_name": {
            "value": "[concat(parameters('client_Name'), '_OrchestatorPart_Sophos_Get_Device_Info_Playbook_Playbook')]"
          },
          "workflows_OrchestatorPart_Sophos_Auth_Playbook_externalid": {
            "value": "[concat(parameters('client_Name'), '_OrchestatorPart_Sophos_Auth_Playbook')]"
          },
          "keyvault_Name": {
            "value": "[parameters('keyvault_Name_Pack')]"
          },
          "connections_azuresentinel_Cliente_Enrich_Sophos_Get_Device_Info_Playbook_externalid": {
            "value": "/subscriptions/a7be9652-e6e6-4284-b1b2-14b4079f777d/resourceGroups/MSSP_Sentinel_Desarollo_ResourceGroup/providers/Microsoft.Web/connections/azuresentinel-Cliente_Enrich_Sophos_Get_Device_Info_Playbook"
          }
        }
      }
    },
    {
      "type": "Microsoft.Resources/deployments",
      "apiVersion": "2025-03-01",
      "name": "OrchestatorPart_Sophos_Get_Recent_Alert_Playbook",
      "dependsOn": [
        "OrchestatorPart_Sophos_Auth_Playbook"
      ],
      "properties": {
        "mode": "Incremental",
        "templateLink": {
          "uri": "https://raw.githubusercontent.com/VelorciosGroup/AzureSentinelARMTemplate/refs/heads/playbook_parse_automation/template_automation/OUTFINAL/out/OrchestatorPart_Sophos_Get_Recent_Alert_Info_Playbook.json",
          "contentVersion": "1.0.0.0"
        },
        "parameters": {
          "workflows_OrchestatorPart_Sophos_Get_Recent_Alert_Info_Playbook_name": {
            "value": "[concat(parameters('client_Name'), '_OrchestatorPart_Sophos_Get_Recent_Alert_Info_Playbook_Playbook')]"
          },
          "workflows_OrchestatorPart_Sophos_Auth_Playbook_externalid": {
            "value": "[concat(parameters('client_Name'), '_OrchestatorPart_Sophos_Auth_Playbook')]"
          },
          "keyvault_Name": {
            "value": "[parameters('keyvault_Name_Pack')]"
          },
          "connections_azuresentinel_Cliente_Enrich_Sophos_Get_Recent_Alert_Info_Playbook_externalid": {
            "value": "/subscriptions/a7be9652-e6e6-4284-b1b2-14b4079f777d/resourceGroups/MSSP_Sentinel_Desarollo_ResourceGroup/providers/Microsoft.Web/connections/azuresentinel-Cliente_Enrich_Sophos_Get_Recent_Alert_Info_Playbook"
          }
        }
      }
    },
    {
      "type": "Microsoft.Resources/deployments",
      "apiVersion": "2025-03-01",
      "name": "OrchestatorPart_Sophos_Launch_Antivirus_Playbook",
      "dependsOn": [
        "OrchestatorPart_Sophos_Auth_Playbook"
      ],
      "properties": {
        "mode": "Incremental",
        "templateLink": {
          "uri": "https://raw.githubusercontent.com/VelorciosGroup/AzureSentinelARMTemplate/refs/heads/playbook_parse_automation/template_automation/OUTFINAL/out/OrchestatorPart_Sophos_Launch_Antivirus_Playbook.json",
          "contentVersion": "1.0.0.0"
        },
        "parameters": {
          "workflows_OrchestatorPart_Sophos_Launch_Antivirus_Playbook_name": {
            "value": "[concat(parameters('client_Name'), '_OrchestatorPart_Sophos_Launch_Antivirus_Playbook_Playbook')]"
          },
          "workflows_OrchestatorPart_Sophos_Auth_Playbook_externalid": {
            "value": "[concat(parameters('client_Name'), '_OrchestatorPart_Sophos_Auth_Playbook')]"
          }
        }
      }
    }
  ],
  "outputs": {
    "postDeployNote": {
      "type": "string",
      "value": "✅ Despliegue completado.\n⚠️ Ahora debes asignar permisos de comentarios a los playbooks: \n⚫ Cliente_Enrich_Sophos_Get_Device_Info_Playbook\n⚫ Cliente_Enrich_Sophos_Get_Recent_Alert_Info_Playbook\nY permisos de keyvault a los playbooks:\n⚫ Cliente_Enrich_Sophos_Get_Recent_Alert_Info_Playbook\n⚫ Cliente_Enrich_Sophos_Get_Device_Info_Playbook\n⚫ Cliente_OrchestatorPart_Sophos_Block_IOC_Playbook\n⚫ Cliente_Action_Sophos_Launch_Antivirus_Playbook\n⚫ Cliente_Action_Sophos_Device_Isolation_Playbook\n⚫ Cliente_Action_Sophos_Block_IP_Playbook\n"
    },
    "postDeployApiTagInstructions": {
      "type": "string",
      "value": "Para asignar correctamente el tag en las policy ⚠️: Acceder a Sophos Central → Mis productos → Endpoint → Policy → Configuración → Añadir nuevo. En el campo \"Etiqueta de sitio web\" hay que poner el tag escogido en el despliegue y en el campo \"Acción\" hay que poner la opción de bloquear"
    }
  }
}
